import{SvelteComponent as G,append as u,attr as $,destroy_each as I,detach as _,element as x,init as M,insert as y,listen as E,noop as O,run_all as z,safe_not_equal as A,set_data as P,space as C,text as k}from"../../web_modules/svelte/internal.js";import{createEventDispatcher as B}from"../../web_modules/svelte.js";import"../6502/instructions/index.js";import{argParamsGenerator as F}from"../6502/disassembler/index.js";function U(a,s,t){const o=a.slice();return o[16]=s[t][0],o[17]=s[t][1],o}function q(a){let s,t,o=a[16]+"",c,m,g,p=a[17]+"",i,d;return{c(){s=x("tr"),t=x("td"),c=k(o),m=C(),g=x("td"),i=k(p),$(t,"class","w-1/3"),$(s,"class",d=a[1]===a[16]?"bg-red-400":"")},m(f,h){y(f,s,h),u(s,t),u(t,c),u(s,m),u(s,g),u(g,i)},p(f,h){h&1&&o!==(o=f[16]+"")&&P(c,o),h&1&&p!==(p=f[17]+"")&&P(i,p),h&3&&d!==(d=f[1]===f[16]?"bg-red-400":"")&&$(s,"class",d)},d(f){f&&_(s)}}}function H(a){let s,t,o,c,m,g,p,i,d,f,h,w=a[0],l=[];for(let r=0;r<w.length;r+=1)l[r]=q(U(a,w,r));return{c(){s=x("div"),t=x("table"),o=x("tr"),c=x("td"),m=x("button"),m.textContent="Up",g=C();for(let r=0;r<l.length;r+=1)l[r].c();p=C(),i=x("td"),d=x("button"),d.textContent="Down",$(m,"class","block w-full"),$(c,"class","text-center"),$(c,"colspan","2"),$(d,"class","block w-full"),$(i,"class","text-center"),$(i,"colspan","2"),$(t,"class","font-mono table-fixed w-full")},m(r,b){y(r,s,b),u(s,t),u(t,o),u(o,c),u(c,m),u(t,g);for(let e=0;e<l.length;e+=1)l[e].m(t,null);u(t,p),u(t,i),u(i,d),f||(h=[E(m,"click",a[2]),E(d,"click",a[3])],f=!0)},p(r,[b]){if(b&3){w=r[0];let e;for(e=0;e<w.length;e+=1){const S=U(r,w,e);l[e]?l[e].p(S,b):(l[e]=q(S),l[e].c(),l[e].m(t,p))}for(;e<l.length;e+=1)l[e].d(1);l.length=w.length}},i:O,o:O,d(r){r&&_(s),I(l,r),f=!1,z(h)}}}function J(a,s,t){const o=B();let{ram:c}=s,{offsetStart:m}=s,{offsetEnd:g}=s,{length:p}=s,{pc:i}=s,{followPC:d=!0}=s;const f=n=>`$${n.toString(16).toUpperCase().padStart(4,"0")}`,h=n=>parseInt(n.replace("$",""),16),w=F(g);function l(){e>0&&o("change",{value:{offsetStart:h(b[e-1][0])}})}function r(){e<65535&&o("change",{value:{offsetStart:h(b[e+1][0])}})}a.$$set=n=>{"ram"in n&&t(4,c=n.ram),"offsetStart"in n&&t(5,m=n.offsetStart),"offsetEnd"in n&&t(6,g=n.offsetEnd),"length"in n&&t(7,p=n.length),"pc"in n&&t(8,i=n.pc),"followPC"in n&&t(9,d=n.followPC)};let b,e,S,j;return a.$$.update=()=>{if(a.$$.dirty&16){t:t(10,b=Object.entries(c))}if(a.$$.dirty&1056){t:t(11,e=b.map(n=>n[0]).indexOf(f(m)))}if(a.$$.dirty&3984){t:t(0,S=(()=>{if(d){const n=b.map(D=>D[0]).indexOf(f(i)),v=Math.floor(p/2);return Object.entries(c).slice(n-v,n+v)}return Object.entries(c).slice(e,e+p)})())}if(a.$$.dirty&256){t:t(1,j=`$${i.toString(16).toUpperCase().padStart(4,"0")}`)}},[S,j,l,r,c,m,g,p,i,d]}class L extends G{constructor(a){super();M(this,a,J,H,A,{ram:4,offsetStart:5,offsetEnd:6,length:7,pc:8,followPC:9})}}export default L;
